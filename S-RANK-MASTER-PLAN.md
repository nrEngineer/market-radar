# ğŸ† å…¨10äº‹æ¥­éƒ¨ Sãƒ©ãƒ³ã‚¯é”æˆãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ©ãƒ³

> **ä½œæˆæ—¥**: 2026-02-18  
> **ç›®æ¨™**: å…¨10éƒ¨ç½² â†’ Sãƒ©ãƒ³ã‚¯ (90/100ä»¥ä¸Š)  
> **æœŸé–“**: 12é€±é–“ (Week 1-12)  
> **ç¾åœ¨ã®ç·åˆè©•ä¾¡**: C+ â†’ ç›®æ¨™: **S (å…¨éƒ¨ç½²90+)**

---

## ğŸ“Š ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

### ç¾çŠ¶ â†’ ç›®æ¨™ãƒãƒƒãƒ”ãƒ³ã‚°

| # | éƒ¨ç½² | ç¾åœ¨ | ç›®æ¨™ | Gap | å„ªå…ˆåº¦ |
|---|------|------|------|-----|--------|
| 1 | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºéƒ¨ | B+(78) | S(95) | +17 | ğŸŸ¡ Medium |
| 2 | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºéƒ¨ | D+(38) | S(90) | +52 | ğŸ”´ High |
| 3 | ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°éƒ¨ | D(32) | S(92) | +60 | ğŸ”´ High |
| 4 | AIãƒ»åˆ†æã‚¨ãƒ³ã‚¸ãƒ³éƒ¨ | C+(55) | S(94) | +39 | ğŸ”´ High |
| 5 | ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£éƒ¨ | C(50) | S(91) | +41 | ğŸ”´ High |
| 6 | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£éƒ¨ â˜… | F(15) | S(96) | +81 | ğŸ”´ğŸ”´ Critical |
| 7 | é‹ç”¨ãƒ»ä¿å®ˆéƒ¨ â˜… | F(12) | S(93) | +81 | ğŸ”´ğŸ”´ Critical |
| 8 | å“è³ªä¿è¨¼éƒ¨ â˜… | F(8) | S(95) | +87 | ğŸ”´ğŸ”´ Critical |
| 9 | ç«¶åˆãƒ»å¸‚å ´åˆ†æéƒ¨ | C-(42) | S(90) | +48 | ğŸŸ¡ Medium |
| 10 | æˆ¦ç•¥ãƒ»ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆéƒ¨ | B-(65) | S(92) | +27 | ğŸŸ¡ Medium |

### ç·åˆã‚¹ã‚³ã‚¢æ¨ç§»ç›®æ¨™

```
Week 0 (ç¾åœ¨): C+  (å¹³å‡ 39.5/100)
Week 2:        C   (å¹³å‡ 55/100)   â€” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç·Šæ€¥ä¿®å¾©å®Œäº†
Week 4:        B-  (å¹³å‡ 65/100)   â€” ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç¨¼åƒ
Week 6:        B+  (å¹³å‡ 75/100)   â€” ãƒ†ã‚¹ãƒˆãƒ»ç›£è¦–åŸºç›¤å®Œæˆ
Week 8:        A-  (å¹³å‡ 82/100)   â€” AIå®Ÿç”¨åŒ–ãƒ»å“è³ªã‚²ãƒ¼ãƒˆå®Œæˆ
Week 10:       A   (å¹³å‡ 88/100)   â€” å…¨æ©Ÿèƒ½ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿åŒ–
Week 12:       S   (å¹³å‡ 92+/100)  â€” Sãƒ©ãƒ³ã‚¯é”æˆ ğŸ†
```

---

## ğŸ”¥ Phase 0: ç·Šæ€¥å¯¾å¿œ (ä»Šæ—¥ä¸­ â€” 2026-02-18)

### P0-1: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³é™¤å»

**ç¾çŠ¶**: `src/app/api/collect/route.ts` ã¨ `src/app/api/data/route.ts` ã« `'Bearer ***REMOVED***'` ãŒãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰

**å¯¾å¿œæ‰‹é †**:
1. ç’°å¢ƒå¤‰æ•° `CRON_SECRET` ã‚’ `.env.local` ã«è¿½åŠ 
2. ä¸¡APIãƒ«ãƒ¼ãƒˆã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ `process.env.CRON_SECRET` ã«ç½®æ›
3. Vercelç’°å¢ƒå¤‰æ•°ã«ã‚‚ `CRON_SECRET` ã‚’è¨­å®š
4. GitHubå±¥æ­´ã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰Šé™¤ (BFG Repo Cleaner)

**å®Ÿè£…ã‚³ãƒ¼ãƒ‰**:
```typescript
// Before (DANGEROUS)
if (authToken !== 'Bearer ***REMOVED***') {

// After (SECURE)
const cronSecret = process.env.CRON_SECRET
if (!cronSecret || authToken !== `Bearer ${cronSecret}`) {
```

### P0-2: Supabase RLSæœ‰åŠ¹åŒ–

**ç¾çŠ¶**: ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã§RLSãŒã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆçŠ¶æ…‹

**å¯¾å¿œæ‰‹é †**:
1. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«RLSæœ‰åŠ¹åŒ–
2. èª­ã¿å–ã‚Šãƒãƒªã‚·ãƒ¼: `anon`ãƒ­ãƒ¼ãƒ«ã«`SELECT`è¨±å¯
3. æ›¸ãè¾¼ã¿ãƒãƒªã‚·ãƒ¼: `service_role`ã®ã¿`INSERT/UPDATE/DELETE`è¨±å¯
4. `collected_data`ã¨`collection_logs`ã¯ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ã¿

**SQLãƒãƒªã‚·ãƒ¼**:
```sql
-- opportunities: èª°ã§ã‚‚èª­ã‚ã‚‹ã€service_roleã®ã¿æ›¸ã‘ã‚‹
ALTER TABLE opportunities ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Public read" ON opportunities FOR SELECT USING (true);
CREATE POLICY "Service write" ON opportunities FOR ALL USING (auth.role() = 'service_role');

-- collected_data: service_roleã®ã¿
ALTER TABLE collected_data ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Service only" ON collected_data FOR ALL USING (auth.role() = 'service_role');
```

### P0-3: npm auditè„†å¼±æ€§ä¿®æ­£

**å¯¾å¿œ**: `npm audit fix --force` å®Ÿè¡Œ + eslinté–¢é€£ã®äº’æ›æ€§ç¢ºèª

---

## ğŸ“‹ éƒ¨ç½²åˆ¥Sãƒ©ãƒ³ã‚¯é”æˆè©³ç´°ãƒ—ãƒ©ãƒ³

---

### ğŸ¨ Dept.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºéƒ¨: B+(78) â†’ S(95)

**Gap**: +17ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜†â˜†â˜† | **æ‰€è¦é€±æ•°**: 6é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (95/100)
- [ ] Lighthouse Performance â‰¥ 95
- [ ] Lighthouse Accessibility â‰¥ 95
- [ ] Lighthouse Best Practices â‰¥ 95
- [ ] Lighthouse SEO â‰¥ 95
- [ ] WCAG 2.1 AAAæº–æ‹ 
- [ ] å…¨ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å®Œå…¨å¯¾å¿œ
- [ ] Core Web Vitalså…¨é …ç›®ã‚°ãƒªãƒ¼ãƒ³
- [ ] ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ å®Œå…¨æ–‡æ›¸åŒ–
- [ ] i18nåŸºç›¤æ§‹ç¯‰ (æ—¥è‹±)
- [ ] ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆStorybookåŒ–

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 2 | Lighthouseå…¨é …ç›®ãƒ†ã‚¹ãƒˆ + aria-labelä¿®æ­£ | Acc â‰¥ 90 | +5 |
| 3 | next/imageæœ€é©åŒ– + LCPæ”¹å–„ | LCP < 2.5s | +3 |
| 4 | ãƒ‡ã‚¶ã‚¤ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³åˆ†é›¢ (tokens.css) | CSS30%å‰Šæ¸› | +2 |
| 5 | ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å®Œå…¨å¯¾å¿œãƒ†ã‚¹ãƒˆ | å…¨BPå‹•ä½œç¢ºèª | +3 |
| 6 | react-intl i18nåŸºç›¤ | æ—¥è‹±åˆ‡æ›¿å¯èƒ½ | +2 |
| 8 | Storybookå°å…¥ + ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ–‡æ›¸åŒ– | å…¨19ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | +2 |

#### å…·ä½“çš„æ”¹å–„ã‚³ãƒ¼ãƒ‰ä¾‹

**ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ”¹å–„**:
```tsx
// Before
<div onClick={handleClick}>ã‚¯ãƒªãƒƒã‚¯</div>

// After (S-Rank)
<button
  onClick={handleClick}
  aria-label="å¸‚å ´ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°"
  role="button"
  tabIndex={0}
>
  ã‚¯ãƒªãƒƒã‚¯
</button>
```

**next/imageæœ€é©åŒ–**:
```tsx
// Before
<img src="/hero.png" alt="hero" />

// After (S-Rank)
import Image from 'next/image'
<Image 
  src="/hero.png" 
  alt="Market Radarãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰" 
  width={1200} 
  height={630}
  priority
  placeholder="blur"
/>
```

---

### âš™ï¸ Dept.2 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºéƒ¨: D+(38) â†’ S(90)

**Gap**: +52ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜…â˜† | **æ‰€è¦é€±æ•°**: 8é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (90/100)
- [ ] å…¨APIãŒSupabase DBæ¥ç¶š (æ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿å®Œå…¨æ’é™¤)
- [ ] JWTèªè¨¼å®Ÿè£… (Supabase Auth)
- [ ] Rate Limiting (100req/min/IP)
- [ ] APIãƒ¬ã‚¹ãƒãƒ³ã‚¹æ¨™æº–åŒ– (RFC 7807 Problem Details)
- [ ] OpenAPI (Swagger) ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆ
- [ ] APIãƒ¬ã‚¹ãƒãƒ³ã‚¹P95 < 500ms
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°100%ã‚«ãƒãƒ¼
- [ ] DBæ¥ç¶šãƒ—ãƒ¼ãƒªãƒ³ã‚°æœ€é©åŒ–
- [ ] APIãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° (v1)

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 1 | `/api/data` ã‚’Supabaseæ¥ç¶šã«ç§»è¡Œ | DBå®Ÿãƒ‡ãƒ¼ã‚¿è¿”å´ | +15 |
| 1 | èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ç’°å¢ƒå¤‰æ•°åŒ– | ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰0ä»¶ | +10 |
| 2 | `/api/collect` ã«DBä¿å­˜å‡¦ç†è¿½åŠ  | INSERTæˆåŠŸ | +8 |
| 3 | Rate Limiting middlewareå®Ÿè£… | 100req/minåˆ¶é™ | +5 |
| 4 | APIãƒ¬ã‚¹ãƒãƒ³ã‚¹æ¨™æº–åŒ– (error types) | çµ±ä¸€ã‚¨ãƒ©ãƒ¼å‹ | +4 |
| 5 | Supabase Auth JWTèªè¨¼çµ±åˆ | èªè¨¼ãƒ•ãƒ­ãƒ¼å®Œæˆ | +5 |
| 6 | OpenAPI specè‡ªå‹•ç”Ÿæˆ | Swagger UIå‹•ä½œ | +3 |
| 8 | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ– | P95 < 500ms | +2 |

#### `/api/data` Supabaseæ¥ç¶šå®Ÿè£…

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { supabase, supabaseAdmin } from '@/lib/supabase'
import { 
  getOpportunitiesFromDB, 
  getTrendsFromDB, 
  getCategoriesFromDB,
  getLatestCollectedData 
} from '@/lib/supabase'

export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url)
    const type = searchParams.get('type')

    switch (type) {
      case 'opportunities':
        const opportunities = await getOpportunitiesFromDB()
        return NextResponse.json({ data: opportunities, count: opportunities.length })
      
      case 'trends':
        const trends = await getTrendsFromDB()
        return NextResponse.json({ data: trends, count: trends.length })
      
      case 'categories':
        const categories = await getCategoriesFromDB()
        return NextResponse.json({ data: categories, count: categories.length })
      
      case 'collection-status':
        const logs = await getLatestCollectedData()
        return NextResponse.json({ data: logs })
      
      case 'stats':
        // Aggregate stats from DB
        const { data: oppCount } = await supabase
          .from('opportunities').select('id', { count: 'exact', head: true })
        const { data: trendCount } = await supabase
          .from('trends').select('id', { count: 'exact', head: true })
        return NextResponse.json({
          totalOpportunities: oppCount?.length ?? 0,
          totalTrends: trendCount?.length ?? 0,
          lastUpdate: new Date().toISOString()
        })
      
      default:
        const allData = {
          opportunities: await getOpportunitiesFromDB(),
          trends: await getTrendsFromDB(),
          categories: await getCategoriesFromDB(),
          lastUpdate: new Date().toISOString()
        }
        return NextResponse.json(allData)
    }
  } catch (error) {
    console.error('Data API error:', error)
    return NextResponse.json(
      { 
        type: 'https://market-radar.dev/errors/internal',
        title: 'Internal Server Error',
        status: 500,
        detail: error instanceof Error ? error.message : 'Unknown error'
      }, 
      { status: 500 }
    )
  }
}
```

---

### ğŸ“Š Dept.3 ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°éƒ¨: D(32) â†’ S(92)

**Gap**: +60ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜…â˜† | **æ‰€è¦é€±æ•°**: 8é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (92/100)
- [ ] 4ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å…¨ã¦å®ŸAPIæ¥ç¶š
- [ ] å…¨åé›†ãƒ‡ãƒ¼ã‚¿ãŒSupabaseã«è‡ªå‹•ä¿å­˜
- [ ] Vercel Cron Job (æ¯æ—¥3:00 JSTè‡ªå‹•åé›†)
- [ ] ETLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ (raw â†’ processed)
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ + é‡è¤‡æ’é™¤
- [ ] ãƒ‡ãƒ¼ã‚¿æ¬ æç‡ < 1%
- [ ] åé›†ãƒ­ã‚°ã®å®Œå…¨è¨˜éŒ²
- [ ] ãƒ‡ãƒ¼ã‚¿é®®åº¦ < 24æ™‚é–“
- [ ] ãƒãƒƒã‚¯ãƒ•ã‚£ãƒ«æ©Ÿèƒ½

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 1 | åé›†ãƒ‡ãƒ¼ã‚¿Supabaseä¿å­˜å®Ÿè£… | collected_dataãƒ†ãƒ¼ãƒ–ãƒ«INSERT | +15 |
| 2 | Product Hunt GraphQL APIå®Ÿè£… | å®Ÿãƒ‡ãƒ¼ã‚¿å–å¾— | +10 |
| 2 | Vercel Cron Jobè¨­å®š | è‡ªå‹•åé›†å‹•ä½œ | +8 |
| 3 | ETLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰ | rawâ†’processedå¤‰æ› | +8 |
| 4 | ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å±¤ | æ¬ æç‡<5% | +6 |
| 5 | é‡è¤‡æ’é™¤ãƒ­ã‚¸ãƒƒã‚¯ | é‡è¤‡0% | +5 |
| 6 | Google Trends APIçµ±åˆ | 4ç•ªç›®ã®ã‚½ãƒ¼ã‚¹ | +5 |
| 8 | ãƒãƒƒã‚¯ãƒ•ã‚£ãƒ« + ãƒ‡ãƒ¼ã‚¿å“è³ªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | æ¬ æç‡<1% | +3 |

#### åé›†â†’DBä¿å­˜ å®Ÿè£…ã‚³ãƒ¼ãƒ‰

```typescript
// src/lib/data-pipeline.ts
import { supabaseAdmin } from './supabase'

export async function saveCollectionResult(result: CollectionResult): Promise<void> {
  const startTime = Date.now()
  
  try {
    // 1. collected_data ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜
    const { error: dataError } = await supabaseAdmin
      .from('collected_data')
      .insert({
        source: result.source,
        raw_data: result.data,
        data_count: result.dataCount,
        status: result.status,
        error: result.error || null,
        metadata: { timestamp: result.timestamp }
      })

    if (dataError) throw dataError

    // 2. collection_logs ã«è¨˜éŒ²
    const executionTime = Date.now() - startTime
    await supabaseAdmin
      .from('collection_logs')
      .insert({
        source: result.source,
        status: result.status,
        data_count: result.dataCount,
        error: result.error || null,
        execution_time_ms: executionTime,
        metadata: { version: '1.0' }
      })

    console.log(`[Pipeline] Saved ${result.dataCount} items from ${result.source} in ${executionTime}ms`)
  } catch (error) {
    console.error(`[Pipeline] Failed to save ${result.source}:`, error)
    throw error
  }
}
```

#### Vercel Cronè¨­å®š

```json
// vercel.json
{
  "crons": [
    {
      "path": "/api/collect",
      "schedule": "0 18 * * *"
    }
  ]
}
```

---

### ğŸ¤– Dept.4 AIãƒ»åˆ†æã‚¨ãƒ³ã‚¸ãƒ³éƒ¨: C+(55) â†’ S(94)

**Gap**: +39ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜…â˜† | **æ‰€è¦é€±æ•°**: 10é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (94/100)
- [ ] OpenAI/Claude APIçµ±åˆã«ã‚ˆã‚‹æ´å¯Ÿç”Ÿæˆ
- [ ] ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ãŒãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã§å‹•ä½œ
- [ ] æ™‚ç³»åˆ—äºˆæ¸¬ãƒ¢ãƒ‡ãƒ« (åŸºæœ¬å›å¸°åˆ†æ)
- [ ] æ„Ÿæƒ…åˆ†æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
- [ ] ãƒ¢ãƒ‡ãƒ«ç²¾åº¦è©•ä¾¡åŸºç›¤ (MAPEè¨ˆæ¸¬)
- [ ] A/Bãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- [ ] äºˆæ¸¬ç²¾åº¦ â‰¥ 70%
- [ ] åˆ†æãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 2 | ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³DBæ¥ç¶š | DBãƒ‡ãƒ¼ã‚¿ã§ã‚¹ã‚³ã‚¢è¨ˆç®— | +8 |
| 3 | OpenAI APIçµ±åˆ (æ´å¯Ÿç”Ÿæˆ) | GPT-4åˆ†æãƒ†ã‚­ã‚¹ãƒˆå‡ºåŠ› | +10 |
| 4 | ã‚¤ãƒ³ã‚µã‚¤ãƒˆã®DBä¿å­˜ãƒ»è¡¨ç¤ºé€£æº | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åæ˜  | +5 |
| 6 | æ™‚ç³»åˆ—äºˆæ¸¬ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ— | åŸºæœ¬å›å¸°åˆ†æå‹•ä½œ | +6 |
| 8 | æ„Ÿæƒ…åˆ†æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | ãƒ¬ãƒ“ãƒ¥ãƒ¼æ„Ÿæƒ…åˆ†é¡ | +5 |
| 10 | ãƒ¢ãƒ‡ãƒ«è©•ä¾¡ãƒ»ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆåŸºç›¤ | MAPEè¨ˆæ¸¬è‡ªå‹•åŒ– | +3 |
| 10 | åˆ†æãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ | é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆPDF | +2 |

#### OpenAIçµ±åˆå®Ÿè£…

```typescript
// src/lib/analysis/ai-insights.ts
import OpenAI from 'openai'

const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY })

export async function generateMarketInsight(data: {
  trends: TrendData[]
  opportunities: OpportunityDetail[]
  recentData: DatabaseCollectedData[]
}): Promise<string> {
  const prompt = `ã‚ãªãŸã¯ä¸€æµã®å¸‚å ´ã‚¢ãƒŠãƒªã‚¹ãƒˆã§ã™ã€‚ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é‡è¦ãªæ´å¯Ÿã‚’3ã¤æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚

## ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ‡ãƒ¼ã‚¿
${JSON.stringify(data.trends.slice(0, 5), null, 2)}

## æ©Ÿä¼šãƒ‡ãƒ¼ã‚¿
${JSON.stringify(data.opportunities.slice(0, 3), null, 2)}

## æœ€æ–°åé›†ãƒ‡ãƒ¼ã‚¿æ¦‚è¦
ã‚½ãƒ¼ã‚¹æ•°: ${data.recentData.length}
ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆ: ${data.recentData.reduce((sum, d) => sum + d.data_count, 0)}

JSONå½¢å¼ã§å›ç­”:
[{"insight": "...", "impact": "positive|negative|neutral", "confidence": 0-100, "actionable": "..."}]`

  const response = await openai.chat.completions.create({
    model: 'gpt-4-turbo-preview',
    messages: [{ role: 'user', content: prompt }],
    temperature: 0.3,
    response_format: { type: 'json_object' }
  })

  return response.choices[0].message.content || '[]'
}
```

---

### ğŸ—ï¸ Dept.5 ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£éƒ¨: C(50) â†’ S(91)

**Gap**: +41ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜†â˜† | **æ‰€è¦é€±æ•°**: 8é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (91/100)
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å…¨ã‚°ãƒªãƒ¼ãƒ³ (ESLintã‚¨ãƒ©ãƒ¼0ä»¶)
- [ ] ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“ < 5åˆ†
- [ ] PRâ†’æœ¬ç•ª 24æ™‚é–“ä»¥å†…
- [ ] Preview Deploy (PRã”ã¨)
- [ ] ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒæ§‹ç¯‰
- [ ] Supabaseãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š
- [ ] CDNæœ€é©åŒ–
- [ ] ç’°å¢ƒå¤‰æ•°ç®¡ç† (Vercel + dotenv-vault)
- [ ] Infrastructure as Code

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 1 | ESLintã‚¨ãƒ©ãƒ¼å…¨ä¿®æ­£ â†’ CIå¾©æ—§ | CIå…¨ã‚°ãƒªãƒ¼ãƒ³ | +12 |
| 2 | Vercel Preview Deployæœ‰åŠ¹åŒ– | PRãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å‹•ä½œ | +5 |
| 3 | ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒæ§‹ç¯‰ | staging.market-radar.app | +6 |
| 4 | Supabaseãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª | RPO/RTOå®šç¾© | +4 |
| 5 | ç’°å¢ƒå¤‰æ•°ç®¡ç†æ”¹å–„ | dotenv-vaultå°å…¥ | +4 |
| 6 | CDNæœ€é©åŒ– + Edge Functions | ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ”¹å–„ | +4 |
| 8 | CI/CDã«ãƒ†ã‚¹ãƒˆå¿…é ˆåŒ– | PRãƒãƒ¼ã‚¸æ¡ä»¶è¨­å®š | +3 |
| 10 | GitHub Actionsãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æœ€é©åŒ– | ãƒ“ãƒ«ãƒ‰ < 3åˆ† | +3 |

---

### ğŸ›¡ï¸ Dept.6 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£éƒ¨: F(15) â†’ S(96) â˜…æœ€é‡è¦

**Gap**: +81ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜…â˜… | **æ‰€è¦é€±æ•°**: 10é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (96/100)
- [ ] ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ 0ä»¶
- [ ] RLSå…¨ãƒ†ãƒ¼ãƒ–ãƒ«æœ‰åŠ¹
- [ ] CSP (Content Security Policy) è¨­å®š
- [ ] Rate Limitingå…¨APIã«é©ç”¨
- [ ] npmè„†å¼±æ€§ 0ä»¶
- [ ] OWASP Top 10å…¨é …ç›®å¯¾å¿œ
- [ ] Dependabot + GitGuardianæœ‰åŠ¹
- [ ] SAST (é™çš„è§£æ) CIçµ±åˆ
- [ ] ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é †
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œè¨ˆç”»
- [ ] å››åŠæœŸãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆè¨ˆç”»
- [ ] ãƒ‡ãƒ¼ã‚¿æš—å·åŒ– (at rest + in transit)

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 0 (ä»Šæ—¥) | ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ãƒˆãƒ¼ã‚¯ãƒ³é™¤å» | ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ0ä»¶ | +15 |
| 0 (ä»Šæ—¥) | npm audit fix | è„†å¼±æ€§0ä»¶ | +5 |
| 1 | Supabase RLSæœ‰åŠ¹åŒ– | ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹é®æ–­ | +12 |
| 1 | .env.local gitignoreç¢ºèª | æ¼æ´©ãƒªã‚¹ã‚¯æ’é™¤ | +3 |
| 2 | CSPãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š | XSSé˜²å¾¡ | +8 |
| 2 | Rate Limitingå®Ÿè£… | DoSé˜²å¾¡ | +5 |
| 3 | Dependabotæœ‰åŠ¹åŒ– | è‡ªå‹•è„†å¼±æ€§ã‚¢ãƒ©ãƒ¼ãƒˆ | +4 |
| 4 | OWASP Top 10ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ | å…¨10é …ç›®ãƒ¬ãƒ“ãƒ¥ãƒ¼ | +6 |
| 5 | GitGuardian / git-secrets | ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆè‡ªå‹•æ¤œçŸ¥ | +4 |
| 6 | SASTå°å…¥ (Semgrep) | CIçµ±åˆ | +5 |
| 8 | ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é † | æ‰‹é †æ›¸å®Œæˆ | +4 |
| 10 | ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œè¨ˆç”» | Runbookå®Œæˆ | +5 |

#### CSPè¨­å®šå®Ÿè£…

```typescript
// next.config.ts
const securityHeaders = [
  {
    key: 'Content-Security-Policy',
    value: [
      "default-src 'self'",
      "script-src 'self' 'unsafe-eval' 'unsafe-inline'",
      "style-src 'self' 'unsafe-inline'",
      "img-src 'self' data: https:",
      "font-src 'self'",
      "connect-src 'self' https://*.supabase.co",
      "frame-ancestors 'none'",
    ].join('; ')
  },
  { key: 'X-Frame-Options', value: 'DENY' },
  { key: 'X-Content-Type-Options', value: 'nosniff' },
  { key: 'Referrer-Policy', value: 'strict-origin-when-cross-origin' },
  { key: 'Permissions-Policy', value: 'camera=(), microphone=(), geolocation=()' },
]

export default {
  async headers() {
    return [{ source: '/(.*)', headers: securityHeaders }]
  }
}
```

---

### ğŸ“¡ Dept.7 é‹ç”¨ãƒ»ä¿å®ˆéƒ¨: F(12) â†’ S(93) â˜…æœ€é‡è¦

**Gap**: +81ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜…â˜† | **æ‰€è¦é€±æ•°**: 10é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (93/100)
- [ ] `/api/health` ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ (DB + å¤–éƒ¨APIç–é€š)
- [ ] Sentryå°å…¥ (ã‚¨ãƒ©ãƒ¼è‡ªå‹•ã‚­ãƒ£ãƒƒãƒ)
- [ ] ç¨¼åƒç‡ç›£è¦– (UptimeRobot)
- [ ] æ§‹é€ åŒ–ãƒ­ã‚° (pino)
- [ ] SLI/SLOå®šç¾©ãƒ»è¨ˆæ¸¬
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ« (ã‚¨ãƒ©ãƒ¼ç‡ > 1% â†’ Slacké€šçŸ¥)
- [ ] ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ (Vercel Analytics)
- [ ] Runbook (éšœå®³ãƒ‘ã‚¿ãƒ¼ãƒ³5ç¨®)
- [ ] ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- [ ] å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
- [ ] ç¨¼åƒç‡ â‰¥ 99.9%

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 1 | `/api/health` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä½œæˆ | 200 OK + DBç–é€š | +10 |
| 1 | Vercel LogsåŸºæœ¬ç¢ºèª | ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°é–²è¦§å¯èƒ½ | +3 |
| 2 | Sentryå°å…¥ | ã‚¨ãƒ©ãƒ¼è‡ªå‹•ã‚­ãƒ£ãƒƒãƒ | +10 |
| 2 | UptimeRobotè¨­å®š | ç¨¼åƒç‡è¨ˆæ¸¬é–‹å§‹ | +8 |
| 3 | æ§‹é€ åŒ–ãƒ­ã‚° (pino) å°å…¥ | JSONå½¢å¼ãƒ­ã‚° | +6 |
| 3 | SLI/SLOå®šç¾©æ–‡æ›¸ | å¯ç”¨æ€§99.9%ç›®æ¨™ | +5 |
| 4 | ã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«è¨­å®š | Slacké€šçŸ¥ãƒ†ã‚¹ãƒˆ | +6 |
| 5 | ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒ•ãƒ­ãƒ¼ | ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾© | +5 |
| 6 | Runbookä½œæˆ (5ãƒ‘ã‚¿ãƒ¼ãƒ³) | éšœå®³å¯¾å¿œæ‰‹é † | +6 |
| 8 | ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | Grafana/Vercel Analytics | +6 |
| 10 | ãƒã‚¹ãƒˆãƒ¢ãƒ¼ãƒ†ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®Œæˆ | +4 |
| 12 | å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ | æœˆæ¬¡ãƒ¡ãƒ³ãƒ†è¨ˆç”» | +4 |

#### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å®Ÿè£…

```typescript
// src/app/api/health/route.ts
import { NextResponse } from 'next/server'
import { supabase } from '@/lib/supabase'

interface HealthStatus {
  status: 'healthy' | 'degraded' | 'unhealthy'
  timestamp: string
  checks: {
    database: { status: string; latencyMs: number }
    api: { status: string }
    memory: { usedMB: number; totalMB: number }
  }
  version: string
  uptime: number
}

export async function GET() {
  const startTime = Date.now()
  const checks: HealthStatus['checks'] = {
    database: { status: 'unknown', latencyMs: 0 },
    api: { status: 'ok' },
    memory: { usedMB: 0, totalMB: 0 }
  }

  // DB Check
  try {
    const dbStart = Date.now()
    const { error } = await supabase.from('collection_logs').select('id').limit(1)
    checks.database = {
      status: error ? 'error' : 'ok',
      latencyMs: Date.now() - dbStart
    }
  } catch {
    checks.database = { status: 'error', latencyMs: -1 }
  }

  // Memory Check
  if (typeof process !== 'undefined') {
    const mem = process.memoryUsage()
    checks.memory = {
      usedMB: Math.round(mem.heapUsed / 1024 / 1024),
      totalMB: Math.round(mem.heapTotal / 1024 / 1024)
    }
  }

  const allOk = checks.database.status === 'ok' && checks.api.status === 'ok'
  
  return NextResponse.json({
    status: allOk ? 'healthy' : 'degraded',
    timestamp: new Date().toISOString(),
    checks,
    version: process.env.npm_package_version || '0.1.0',
    responseTimeMs: Date.now() - startTime
  }, { status: allOk ? 200 : 503 })
}
```

---

### âœ… Dept.8 å“è³ªä¿è¨¼éƒ¨: F(8) â†’ S(95) â˜…æœ€é‡è¦

**Gap**: +87ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜…â˜… | **æ‰€è¦é€±æ•°**: 10é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (95/100)
- [ ] Vitestå°å…¥ + ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ50ä»¶+
- [ ] Playwright E2Eãƒ†ã‚¹ãƒˆ (ä¸»è¦ãƒ•ãƒ­ãƒ¼5ä»¶)
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ â‰¥ 90%
- [ ] ESLintã‚¨ãƒ©ãƒ¼ 0ä»¶
- [ ] TypeScript strict modeé•å 0ä»¶
- [ ] `any`å‹ 0ä»¶
- [ ] CIå¿…é ˆãƒ†ã‚¹ãƒˆ (PRãƒãƒ¼ã‚¸æ¡ä»¶)
- [ ] Lighthouse CIã‚¹ã‚³ã‚¢é–¾å€¤
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯
- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 1 | Vitestå°å…¥ + è¨­å®š | ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼å‹•ä½œ | +5 |
| 1 | `any`å‹â†’proper typesä¿®æ­£ | ESLintã‚¨ãƒ©ãƒ¼0ä»¶ | +10 |
| 2 | ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ãƒ†ã‚¹ãƒˆ (10ä»¶) | å…¨ãƒ‘ã‚¹ | +8 |
| 3 | API Routeãƒ†ã‚¹ãƒˆ (10ä»¶) | å…¨ãƒ‘ã‚¹ | +8 |
| 4 | Playwright E2EåŸºç›¤ | 3ãƒšãƒ¼ã‚¸ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ | +8 |
| 5 | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ (10ä»¶) | å…¨ãƒ‘ã‚¹ | +6 |
| 6 | ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸50%é”æˆ | Vitest coverage | +8 |
| 7 | CIå¿…é ˆãƒ†ã‚¹ãƒˆè¨­å®š | PRãƒãƒ¼ã‚¸æ¡ä»¶ | +6 |
| 8 | Lighthouse CIé–¾å€¤è¨­å®š | ã‚¹ã‚³ã‚¢è‡ªå‹•ãƒã‚§ãƒƒã‚¯ | +5 |
| 10 | ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸90%é”æˆ | å…¨é–¢æ•°ã‚«ãƒãƒ¼ | +10 |
| 12 | ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ | æ–‡æ›¸å®Œæˆ | +4 |

#### Vitestè¨­å®š

```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig({
  plugins: [react()],
  test: {
    environment: 'jsdom',
    globals: true,
    setupFiles: ['./src/test/setup.ts'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80
        }
      }
    }
  },
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  }
})
```

#### ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚¨ãƒ³ã‚¸ãƒ³ãƒ†ã‚¹ãƒˆä¾‹

```typescript
// src/lib/analysis/__tests__/scoring.test.ts
import { describe, it, expect } from 'vitest'
import { calculateScore, ScoringInput, SCORING_WEIGHTS } from '../scoring'

describe('Scoring Engine', () => {
  const baseInput: ScoringInput = {
    samValue: 10_000_000_000, // 10B JPY
    cagr: 25,
    herfindahlIndex: 1500,
    competitorCount: 15,
    techComplexity: 70,
    costFeasibility: 60,
    teamFit: 80,
    adoptionStage: 'early_adopters',
    trendMomentum: 75,
    networkEffects: 60,
    switchingCosts: 50,
    dataAdvantage: 70,
    brandValue: 40,
  }

  it('should calculate overall score between 0 and 100', () => {
    const result = calculateScore(baseInput)
    expect(result.overall).toBeGreaterThanOrEqual(0)
    expect(result.overall).toBeLessThanOrEqual(100)
  })

  it('should return all 6 component scores', () => {
    const result = calculateScore(baseInput)
    expect(result.marketSize).toBeDefined()
    expect(result.growth).toBeDefined()
    expect(result.competition).toBeDefined()
    expect(result.feasibility).toBeDefined()
    expect(result.timing).toBeDefined()
    expect(result.moat).toBeDefined()
  })

  it('should have weights that sum to 1.0', () => {
    const total = Object.values(SCORING_WEIGHTS).reduce((a, b) => a + b, 0)
    expect(total).toBeCloseTo(1.0)
  })

  it('should give higher score for larger SAM', () => {
    const smallSam = calculateScore({ ...baseInput, samValue: 1_000_000 })
    const largeSam = calculateScore({ ...baseInput, samValue: 50_000_000_000 })
    expect(largeSam.marketSize).toBeGreaterThan(smallSam.marketSize)
  })

  it('should give score of 0 for SAM of 0', () => {
    const result = calculateScore({ ...baseInput, samValue: 0 })
    expect(result.marketSize).toBe(0)
  })

  it('should cap growth score at 100 for very high CAGR', () => {
    const result = calculateScore({ ...baseInput, cagr: 200 })
    expect(result.growth).toBeLessThanOrEqual(100)
  })

  it('should provide complete breakdown with formulas', () => {
    const result = calculateScore(baseInput)
    expect(result.breakdown.marketSize.formula).toBeTruthy()
    expect(result.breakdown.marketSize.calculation).toBeTruthy()
    expect(result.breakdown.marketSize.weight).toBe(SCORING_WEIGHTS.marketSize)
  })

  it('should penalize concentrated markets', () => {
    const fragmented = calculateScore({ ...baseInput, herfindahlIndex: 500 })
    const concentrated = calculateScore({ ...baseInput, herfindahlIndex: 8000 })
    expect(fragmented.competition).toBeGreaterThan(concentrated.competition)
  })

  it('should favor early_adopters timing', () => {
    const early = calculateScore({ ...baseInput, adoptionStage: 'early_adopters' })
    const late = calculateScore({ ...baseInput, adoptionStage: 'laggards' })
    expect(early.timing).toBeGreaterThan(late.timing)
  })

  it('should be reproducible (same input â†’ same output)', () => {
    const result1 = calculateScore(baseInput)
    const result2 = calculateScore(baseInput)
    expect(result1.overall).toBe(result2.overall)
    expect(result1.breakdown).toEqual(result2.breakdown)
  })
})
```

---

### ğŸ” Dept.9 ç«¶åˆãƒ»å¸‚å ´åˆ†æéƒ¨: C-(42) â†’ S(90)

**Gap**: +48ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜†â˜† | **æ‰€è¦é€±æ•°**: 10é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (90/100)
- [ ] ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿â†’DBå®Ÿãƒ‡ãƒ¼ã‚¿å®Œå…¨ç§»è¡Œ
- [ ] ç«¶åˆè‡ªå‹•æ¤œå‡ºãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- [ ] æ—¥æ¬¡ç«¶åˆæ›´æ–°
- [ ] Google Trendså®Ÿãƒ‡ãƒ¼ã‚¿çµ±åˆ
- [ ] ç«¶åˆãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- [ ] PESTåˆ†ææ©Ÿèƒ½
- [ ] é€±æ¬¡è‡ªå‹•ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ (Slacké€šçŸ¥)
- [ ] å¸‚å ´ãƒ‡ãƒ¼ã‚¿é®®åº¦ < 24æ™‚é–“

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 2 | ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿â†’DBç§»è¡Œ | DBå‹•çš„å–å¾— | +12 |
| 4 | ç«¶åˆè‡ªå‹•åˆ†é¡ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ | æ—¥æ¬¡ç«¶åˆæ›´æ–° | +10 |
| 6 | Google Trendsçµ±åˆ | ãƒªã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿åæ˜  | +8 |
| 8 | ç«¶åˆãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆ | +8 |
| 9 | PESTåˆ†ææ©Ÿèƒ½ | 4è¦ç´ åˆ†æè¡¨ç¤º | +5 |
| 10 | é€±æ¬¡è‡ªå‹•ãƒ¬ãƒãƒ¼ãƒˆ | Slacké€šçŸ¥ | +5 |

---

### ğŸ“ˆ Dept.10 æˆ¦ç•¥ãƒ»ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆéƒ¨: B-(65) â†’ S(92)

**Gap**: +27ç‚¹ | **é›£æ˜“åº¦**: â˜…â˜…â˜…â˜†â˜† | **æ‰€è¦é€±æ•°**: 10é€±

#### Sãƒ©ãƒ³ã‚¯é”æˆæ¡ä»¶ (92/100)
- [ ] KPIè¨ˆæ¸¬ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ (ä¸»è¦5KPIè‡ªå‹•è¨ˆæ¸¬)
- [ ] GitHub Projectsã‚¿ã‚¹ã‚¯ç®¡ç†
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ©Ÿæ§‹
- [ ] GTMæˆ¦ç•¥å…·ä½“åŒ– (ãƒãƒ£ãƒãƒ«åˆ¥CAC)
- [ ] åç›ŠåŒ–ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— (Stripeçµ±åˆè¨ˆç”»)
- [ ] NPSèª¿æŸ»åŸºç›¤
- [ ] ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—å¯è¦–åŒ–
- [ ] OKRè¨­å®šãƒ»ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°

#### é€±æ¬¡ã‚¿ã‚¹ã‚¯

| Week | ã‚¿ã‚¹ã‚¯ | æˆåŠŸæŒ‡æ¨™ | ã‚¹ã‚³ã‚¢å¯„ä¸ |
|------|--------|---------|-----------|
| 1 | GitHub Projectsè¨­å®š | å…¨ã‚¿ã‚¹ã‚¯å¯è¦–åŒ– | +5 |
| 4 | KPIè¨ˆæ¸¬ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | 5KPIè‡ªå‹•è¨ˆæ¸¬ | +8 |
| 6 | ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ•ã‚©ãƒ¼ãƒ å®Ÿè£… | ãƒ¦ãƒ¼ã‚¶ãƒ¼FBåé›† | +4 |
| 8 | GTMæˆ¦ç•¥å…·ä½“åŒ– | ãƒãƒ£ãƒãƒ«åˆ¥CAC | +4 |
| 8 | åç›ŠåŒ–ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— | Stripeè¨ˆç”» | +3 |
| 10 | NPSèª¿æŸ»åŸºç›¤ | åˆå›èª¿æŸ»å®Ÿæ–½ | +3 |

---

## ğŸ—ºï¸ 12é€±é–“ çµ±åˆãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— (ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆ)

```
Week:  1   2   3   4   5   6   7   8   9   10  11  12
       â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€ â”€â”€â”€
D1 FE  â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–‘â–‘â–‘â”‚â–‘â–‘â–‘â”‚   â”‚   â”‚   â”‚   â”‚ 78â†’95
D2 BE  â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–‘â–‘â–‘â”‚â–‘â–‘â–‘â”‚   â”‚   â”‚â–‘â–‘â–‘â”‚â–‘â–‘â–‘â”‚ 38â†’90
D3 DE  â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–‘â–‘â–‘â”‚â–‘â–‘â–‘â”‚   â”‚   â”‚   â”‚   â”‚ 32â†’92
D4 AI  â”‚   â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–’â–’â–’â”‚   â”‚â–’â–’â–’â”‚   â”‚â–’â–’â–’â”‚   â”‚â–‘â–‘â–‘â”‚   â”‚   â”‚ 55â†’94
D5 IF  â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚   â”‚â–‘â–‘â–‘â”‚   â”‚â–‘â–‘â–‘â”‚   â”‚   â”‚ 50â†’91
D6 SC  â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚   â”‚â–’â–’â–’â”‚   â”‚â–‘â–‘â–‘â”‚   â”‚   â”‚ 15â†’96
D7 OP  â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚   â”‚â–’â–’â–’â”‚   â”‚â–‘â–‘â–‘â”‚   â”‚â–‘â–‘â–‘â”‚ 12â†’93
D8 QA  â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–“â–“â–“â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚   â”‚â–‘â–‘â–‘â”‚   â”‚â–‘â–‘â–‘â”‚ 8â†’95
D9 MA  â”‚   â”‚â–“â–“â–“â”‚   â”‚â–’â–’â–’â”‚   â”‚â–’â–’â–’â”‚   â”‚â–’â–’â–’â”‚â–’â–’â–’â”‚â–‘â–‘â–‘â”‚   â”‚   â”‚ 42â†’90
D10 SP â”‚â–“â–“â–“â”‚   â”‚   â”‚â–’â–’â–’â”‚   â”‚â–’â–’â–’â”‚   â”‚â–’â–’â–’â”‚   â”‚â–‘â–‘â–‘â”‚   â”‚   â”‚ 65â†’92

â–“ = Critical (P0/P1)  â–’ = Important (P2)  â–‘ = Enhancement (P3)
```

---

## ğŸ“Š é€±æ¬¡ã‚¹ã‚³ã‚¢æ¨ç§»äºˆæ¸¬

| Week | D1 | D2 | D3 | D4 | D5 | D6 | D7 | D8 | D9 | D10 | å¹³å‡ | è©•ä¾¡ |
|------|----|----|----|----|----|----|----|----|----|----|------|------|
| 0 | 78 | 38 | 32 | 55 | 50 | 15 | 12 | 8 | 42 | 65 | **39.5** | C+ |
| 2 | 83 | 61 | 57 | 63 | 67 | 50 | 43 | 31 | 42 | 70 | **56.7** | C |
| 4 | 86 | 73 | 72 | 76 | 75 | 68 | 60 | 57 | 54 | 78 | **69.9** | B- |
| 6 | 90 | 80 | 82 | 82 | 82 | 78 | 71 | 73 | 65 | 82 | **78.5** | B+ |
| 8 | 92 | 85 | 87 | 88 | 86 | 86 | 82 | 83 | 78 | 87 | **85.4** | A- |
| 10 | 94 | 88 | 90 | 92 | 89 | 92 | 88 | 90 | 85 | 90 | **89.8** | A |
| 12 | **95** | **90** | **92** | **94** | **91** | **96** | **93** | **95** | **90** | **92** | **92.8** | **S** ğŸ† |

---

## æ¬¡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

1. âœ… **S-RANK-MASTER-PLAN.md** (æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ) â€” å…¨10éƒ¨ç½²ã®Sãƒ©ãƒ³ã‚¯é”æˆãƒ—ãƒ©ãƒ³
2. â†’ **S-RANK-QUALITY-STANDARDS.md** â€” SaaSé–‹ç™ºãƒ—ãƒ­ä¼æ¥­å“è³ªåŸºæº–
3. â†’ **S-RANK-AUTOMATION-SYSTEM.md** â€” ç¶™ç¶šçš„å“è³ªå‘ä¸Šã®è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ
4. â†’ **S-RANK-KNOWLEDGE-SYSTEM.md** â€” å…¨ãƒ—ãƒ­ã‚»ã‚¹ã®è¨˜éŒ²ãƒ»ãƒŠãƒ¬ãƒƒã‚¸åŒ–ã‚·ã‚¹ãƒ†ãƒ 
5. â†’ **S-RANK-WEEKLY-REPORT-TEMPLATE.md** â€” é€±æ¬¡Sãƒ©ãƒ³ã‚¯é€²æ—ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
